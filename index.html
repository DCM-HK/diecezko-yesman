<!DOCTYPE html>
<html lang="cs">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Diec√©zn√≠ YesMan</title>
    <style>
      html,
      body {
        scroll-behavior: smooth;
        margin: 0;
        padding: 0;
        background: #f5efe7;
        color: #213555;
        font-family: "Roboto", Arial, sans-serif;
        font-size: 1.1rem;
        display: flex;
        min-height: 100vh;
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        touch-action: manipulation;
      }

      header,
      main,
      footer {
        width: 90vw;
        max-width: 800px;
      }

      main {
        margin-top: 1rem;
      }

      h1,
      h2 {
        /* text-align: center; */
        margin-top: 0.5rem;
        width: 100%;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-bottom: 1rem;
      }

      th,
      td {
        padding: 0.5rem;
        border: 1px solid #ccc;
      }

      input {
        width: 100%;
        padding: 0.4rem;
        box-sizing: border-box;
        font-size: 1rem;
      }

      .btn {
        padding: 0.75rem 1.5rem;
        font-size: 1rem;
        background-color: #4f709c;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        margin-top: 1rem;
        transition: background-color 0.3s ease;
        width: 100%;
        max-width: 300px;
      }

      .btn:hover {
        background-color: #213555;
      }

      .btn-small {
        font-size: 0.9rem;
        padding: 0.5rem;
        background-color: #213555;
        cursor: pointer;
        border-radius: 6px;
      }

      .btn-small:hover {
        background-color: #213555;
      }

      .hidden {
        display: none !important;
      }
      .sumInfo {
        margin-top: 1rem;
      }
      .phase {
        width: 100%;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
      }

      p {
        line-height: 1.5rem;
        width: 100%;
      }

      @media (max-width: 500px) {
        th,
        td {
          font-size: 0.9rem;
        }

        .btn {
          font-size: 1rem;
        }
      }
    </style>
  </head>
  <body>
    <main>
      <h1>Diec√©zn√≠ YesMan</h1>

      <!-- F√°ze 0 ‚Äì √övod -->
      <div id="phase0">
        <h2>V√≠tej v Diec√©zn√≠ YesManu!</h2>
        <p>
          Jak to funguje? Postupnƒõ <strong>dostane≈° nƒõkolik √∫kol≈Ø</strong>,
          kter√© pokus√≠≈° splnit. Pokud to zvl√°dne≈°, zobraz√≠ se ti nakonec
          animace, d√≠ky kter√© m≈Ø≈æe≈° z√≠skat svou odmƒõnu. Podrobnƒõj≈°√≠ instrukce
          o&nbsp;odmƒõnƒõ z√≠sk√°≈° a≈æ po √∫spƒõ≈°n√©m splnƒõn√≠ v≈°ech √∫kol≈Ø.
        </p>
        <p><strong>A pamatuj, vyhr√°t m≈Ø≈æe opravdu ka≈æd√Ω.</strong></p>
        <p>Jsi p≈ôipraven√Ω/√°?</p>
        <button class="btn" onclick="goToPhase1()">‚úÖ Jdu na to!</button>
      </div>

      <!-- F√°ze 1 -->
      <div id="phase1" class="hidden phase">
        <h2>Prvn√≠ √∫kol</h2>
        <p>Seznam se s&nbsp;lidmi, jejich vƒõk v&nbsp;souƒçtu d√° ƒç√≠slo 210.</p>
        <table id="table1">
          <thead>
            <tr>
              <th>Jm√©no</th>
              <th>Vƒõk</th>
              <th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <button class="btn" onclick="addRowPhase1()">P≈ôidat zn√°m√©ho</button>
        <div class="sumInfo">
          Souƒçet vƒõku: <strong><span id="ageSum">0</span> / 210</strong>
        </div>
        <button id="toPhase2Btn" class="btn hidden" onclick="goToPhase2()">
          ‚û°Ô∏è P≈ôej√≠t na dal≈°√≠ √∫kol
        </button>
      </div>

      <!-- F√°ze 2 -->
      <div id="phase2" class="hidden phase">
        <h2>Druh√Ω √∫kol</h2>
        <p>
          V&nbsp;druh√© f√°zi mus√≠≈° splnit n√°sleduj√≠c√≠ch pƒõt √∫kol≈Ø, ka≈æd√Ω
          s&nbsp;nƒõk√Ωm jin√Ωm.
        </p>
        <table id="table2">
          <thead>
            <tr>
              <th>√ökol</th>
              <th>S k√Ωm splnƒõno</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Up≈ô√≠mnƒõ nƒõkomu ≈ô√≠ct, ≈æe mu to slu≈°√≠</td>
              <td><input /></td>
            </tr>
            <tr>
              <td>
                Poznat nƒõkoho z&nbsp;vikari√°tu, kter√Ω soused√≠ s&nbsp;t√≠m tv√Ωm
              </td>
              <td><input /></td>
            </tr>
            <tr>
              <td>ZaHr√°t si s&nbsp;nƒõk√Ωm ƒåing ƒåonG</td>
              <td><input /></td>
            </tr>
            <tr>
              <td>Naj√≠t nƒõkoho, kdo letos pojede do ≈ò√≠ma</td>
              <td><input /></td>
            </tr>
            <tr>
              <td>Popov√≠dat si s&nbsp;nƒõk√Ωm v&nbsp;ciz√≠m jazyce</td>
              <td><input /></td>
            </tr>
          </tbody>
        </table>
        <button id="showResultBtn" class="btn hidden" onclick="showResult()">
          Chci j√≠t d√°l
        </button>
      </div>

      <!-- V√Ωsledek -->
      <div id="result" class="hidden phase">
        <h2>üéâ Hotovo, dobr√° pr√°ce!</h2>
        <p>
          Gratulujeme, aƒç je to mo≈æn√° neƒçekan√©, splnil jsi v≈°echny √∫koly
          a&nbsp;vyhr√°l jsi leto≈°n√≠ho diec√©zn√≠ho YesMana! Nyn√≠ m√°≈° mo≈ænost si
          zaj√≠t pro svoji odmƒõnu do Minutov√©ho nealko baru, kde se prok√°≈æe≈°
          n√°sleduj√≠c√≠ animac√≠.
        </p>
      </div>
    </main>

    <script>
      const phase0Div = document.getElementById("phase0");
      const phase1Div = document.getElementById("phase1");
      const phase2Div = document.getElementById("phase2");
      const resultDiv = document.getElementById("result");
      const ageSumEl = document.getElementById("ageSum");
      const table1Body = document.querySelector("#table1 tbody");
      const toPhase2Btn = document.getElementById("toPhase2Btn");
      const showResultBtn = document.getElementById("showResultBtn");

      const savedPhase = localStorage.getItem("phase") || "0";
      const savedTable1 = JSON.parse(localStorage.getItem("table1") || "[]");
      const savedTasks = JSON.parse(localStorage.getItem("tasks") || "[]");

      function showPhase(phase) {
        [phase0Div, phase1Div, phase2Div, resultDiv].forEach((div) =>
          div.classList.add("hidden")
        );
        if (phase === "0") phase0Div.classList.remove("hidden");
        else if (phase === "1") phase1Div.classList.remove("hidden");
        else if (phase === "2") phase2Div.classList.remove("hidden");
        else if (phase === "done") resultDiv.classList.remove("hidden");
      }

      showPhase(savedPhase);

      function goToPhase1() {
        localStorage.setItem("phase", "1");
        showPhase("1");
        renderTable1();
      }

      function renderTable1() {
        table1Body.innerHTML = "";
        savedTable1.forEach(({ name, age }, i) => {
          const row = table1Body.insertRow();
          row.innerHTML = `
            <td><input value="${name}" oninput="updateRow(${i}, 'name', this.value)"></td>
            <td><input type="number" value="${age}" oninput="updateRow(${i}, 'age', this.value)" min="1" max="65"></td>
            <td><button class="btn-small" onclick="removeRow(${i})">üóëÔ∏è</button></td>
          `;
        });
        updateAgeSum();
      }

      function addRowPhase1() {
        savedTable1.push({ name: "", age: 0 });
        saveTable1();
        renderTable1();
      }

      function removeRow(i) {
        savedTable1.splice(i, 1);
        saveTable1();
        renderTable1();
      }

      function updateRow(i, key, value) {
        if (key === "age") value = parseInt(value) || 0;
        savedTable1[i][key] = value;
        saveTable1();
        updateAgeSum();
      }

      function updateAgeSum() {
        const sum = savedTable1.reduce((s, r) => s + (parseInt(r.age) || 0), 0);
        ageSumEl.textContent = sum;
        toPhase2Btn.classList.toggle("hidden", sum !== 210);
      }

      function saveTable1() {
        localStorage.setItem("table1", JSON.stringify(savedTable1));
      }

      function goToPhase2() {
        localStorage.setItem("phase", "2");
        showPhase("2");
      }

      renderTable1();

      const inputs = document.querySelectorAll("#table2 input");
      inputs.forEach((input, i) => {
        input.value = savedTasks[i] || "";
        input.addEventListener("input", () => {
          savedTasks[i] = input.value;
          localStorage.setItem("tasks", JSON.stringify(savedTasks));
          checkTasksComplete();
        });
      });

      function checkTasksComplete() {
        const complete = [...inputs].every(
          (input) => input.value.trim() !== ""
        );
        showResultBtn.classList.toggle("hidden", !complete);
      }

      checkTasksComplete();

      function showResult() {
        localStorage.setItem("phase", "done");
        showPhase("done");
      }
    </script>
  </body>
</html>
